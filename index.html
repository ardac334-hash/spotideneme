<!DOCTYPE html>
<html>
<head>
  <title>Spotify Basit Analiz</title>
</head>
<body>
  <h1>Spotify Havalı Analiz</h1>
  <button id="login">Spotify ile Giriş Yap</button>
  <div id="results"></div>

  <script>
    const client_id = "4f9325f881bf4c1e92b9e41c7fadc4ef"; // senin Client ID
    const redirect_uri = "http://127.0.0.1:5500/"; 
    const scopes = "user-top-read";

    // Giriş butonu
    document.getElementById("login").onclick = () => {
      window.location = `https://accounts.spotify.com/authorize?client_id=${client_id}&response_type=token&redirect_uri=${redirect_uri}&scope=${scopes}`;
    }

    // URL’den token al
    const hash = window.location.hash.substring(1).split("&").reduce((res, item) => {
      let parts = item.split("=");
      res[parts[0]] = parts[1];
      return res;
    }, {});

    const access_token = hash.access_token;

    if(access_token){
      fetch("https://api.spotify.com/v1/me/top/tracks?limit=10", {
        headers: { "Authorization": "Bearer " + access_token }
      })
      .then(res => res.json())
      .then(data => {
        let html = "<h2>En Çok Dinlenen Şarkılar</h2><ul>";
        data.items.forEach(track => {
          html += `<li>${track.name} - ${track.artists[0].name}</li>`;
        });
        html += "</ul>";
        document.getElementById("results").innerHTML = html;
      });
    }
  </script>
</body>
</html>
